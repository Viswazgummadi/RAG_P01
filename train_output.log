nohup: ignoring input
Loading and preparing dataset...
Loading model: mistralai/Mistral-7B-Instruct-v0.2
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:01<00:02,  1.05s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:02<00:01,  1.08s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.04s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:03<00:00,  1.05s/it]
Setting up LoRA for efficient fine-tuning...
Tokenizing dataset...
Map:   0%|          | 0/5713 [00:00<?, ? examples/s]Map:  18%|█▊        | 1000/5713 [00:00<00:04, 1139.47 examples/s]Map:  35%|███▌      | 2000/5713 [00:01<00:02, 1381.46 examples/s]Map:  53%|█████▎    | 3000/5713 [00:02<00:01, 1479.48 examples/s]Map:  70%|███████   | 4000/5713 [00:02<00:01, 1565.64 examples/s]Map:  88%|████████▊ | 5000/5713 [00:03<00:00, 1627.74 examples/s]Map: 100%|██████████| 5713/5713 [00:03<00:00, 1564.45 examples/s]Map: 100%|██████████| 5713/5713 [00:03<00:00, 1514.97 examples/s]
Starting training...
  0%|          | 0/1071 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
/export/home/kote/miniconda3/envs/rag_env/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:632: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
  0%|          | 1/1071 [00:14<4:18:32, 14.50s/it]  0%|          | 2/1071 [00:28<4:14:37, 14.29s/it]  0%|          | 3/1071 [00:42<4:13:25, 14.24s/it]  0%|          | 4/1071 [00:57<4:12:51, 14.22s/it]  0%|          | 5/1071 [01:11<4:12:32, 14.21s/it]  1%|          | 6/1071 [01:25<4:12:20, 14.22s/it]  1%|          | 7/1071 [01:39<4:12:05, 14.22s/it]  1%|          | 8/1071 [01:53<4:11:56, 14.22s/it]  1%|          | 9/1071 [02:08<4:11:51, 14.23s/it]  1%|          | 10/1071 [02:22<4:11:44, 14.24s/it]                                                     1%|          | 10/1071 [02:22<4:11:44, 14.24s/it]  1%|          | 11/1071 [02:36<4:11:37, 14.24s/it]  1%|          | 12/1071 [02:50<4:11:25, 14.24s/it]  1%|          | 13/1071 [03:05<4:11:19, 14.25s/it]  1%|▏         | 14/1071 [03:19<4:11:07, 14.25s/it]  1%|▏         | 15/1071 [03:33<4:10:58, 14.26s/it]  1%|▏         | 16/1071 [03:47<4:10:45, 14.26s/it]  2%|▏         | 17/1071 [04:02<4:10:30, 14.26s/it]  2%|▏         | 18/1071 [04:16<4:10:17, 14.26s/it]  2%|▏         | 19/1071 [04:30<4:10:05, 14.26s/it]  2%|▏         | 20/1071 [04:45<4:09:52, 14.26s/it]                                                     2%|▏         | 20/1071 [04:45<4:09:52, 14.26s/it]  2%|▏         | 21/1071 [04:59<4:09:40, 14.27s/it]  2%|▏         | 22/1071 [05:13<4:09:27, 14.27s/it]  2%|▏         | 23/1071 [05:27<4:09:14, 14.27s/it]  2%|▏         | 24/1071 [05:42<4:09:04, 14.27s/it]  2%|▏         | 25/1071 [05:56<4:08:51, 14.27s/it]  2%|▏         | 26/1071 [06:10<4:08:38, 14.28s/it]  3%|▎         | 27/1071 [06:24<4:08:23, 14.28s/it]  3%|▎         | 28/1071 [06:39<4:08:07, 14.27s/it]  3%|▎         | 29/1071 [06:53<4:07:55, 14.28s/it]  3%|▎         | 30/1071 [07:07<4:07:41, 14.28s/it]                                                     3%|▎         | 30/1071 [07:07<4:07:41, 14.28s/it]  3%|▎         | 31/1071 [07:22<4:07:26, 14.28s/it]  3%|▎         | 32/1071 [07:36<4:07:09, 14.27s/it]  3%|▎         | 33/1071 [07:50<4:06:57, 14.28s/it]  3%|▎         | 34/1071 [08:04<4:06:10, 14.24s/it]  3%|▎         | 35/1071 [08:19<4:06:09, 14.26s/it]  3%|▎         | 36/1071 [08:33<4:06:01, 14.26s/it]  3%|▎         | 37/1071 [08:47<4:05:53, 14.27s/it]  4%|▎         | 38/1071 [09:01<4:05:43, 14.27s/it]  4%|▎         | 39/1071 [09:16<4:05:31, 14.27s/it]  4%|▎         | 40/1071 [09:30<4:05:16, 14.27s/it]                                                     4%|▎         | 40/1071 [09:30<4:05:16, 14.27s/it]  4%|▍         | 41/1071 [09:44<4:05:03, 14.27s/it]  4%|▍         | 42/1071 [09:59<4:04:51, 14.28s/it]  4%|▍         | 43/1071 [10:13<4:04:38, 14.28s/it]  4%|▍         | 44/1071 [10:27<4:04:20, 14.28s/it]  4%|▍         | 45/1071 [10:41<4:04:09, 14.28s/it]  4%|▍         | 46/1071 [10:56<4:03:55, 14.28s/it]  4%|▍         | 47/1071 [11:10<4:03:41, 14.28s/it]  4%|▍         | 48/1071 [11:24<4:03:25, 14.28s/it]  5%|▍         | 49/1071 [11:38<4:03:10, 14.28s/it]  5%|▍         | 50/1071 [11:53<4:02:57, 14.28s/it]                                                     5%|▍         | 50/1071 [11:53<4:02:57, 14.28s/it]  5%|▍         | 51/1071 [12:07<4:02:44, 14.28s/it]  5%|▍         | 52/1071 [12:21<4:02:29, 14.28s/it]  5%|▍         | 53/1071 [12:36<4:02:09, 14.27s/it]  5%|▌         | 54/1071 [12:50<4:01:56, 14.27s/it]  5%|▌         | 55/1071 [13:04<4:01:42, 14.27s/it]  5%|▌         | 56/1071 [13:18<4:01:29, 14.28s/it]  5%|▌         | 57/1071 [13:33<4:01:16, 14.28s/it]  5%|▌         | 58/1071 [13:47<4:01:01, 14.28s/it]  6%|▌         | 59/1071 [14:01<4:00:49, 14.28s/it]  6%|▌         | 60/1071 [14:15<4:00:35, 14.28s/it]                                                     6%|▌         | 60/1071 [14:15<4:00:35, 14.28s/it]  6%|▌         | 61/1071 [14:30<4:00:22, 14.28s/it]  6%|▌         | 62/1071 [14:44<4:00:05, 14.28s/it]  6%|▌         | 63/1071 [14:58<3:59:49, 14.28s/it]  6%|▌         | 64/1071 [15:13<3:59:35, 14.28s/it]  6%|▌         | 65/1071 [15:27<3:59:20, 14.27s/it]  6%|▌         | 66/1071 [15:41<3:59:04, 14.27s/it]  6%|▋         | 67/1071 [15:55<3:58:51, 14.27s/it]  6%|▋         | 68/1071 [16:10<3:58:35, 14.27s/it]  6%|▋         | 69/1071 [16:24<3:58:22, 14.27s/it]  7%|▋         | 70/1071 [16:38<3:58:08, 14.27s/it]                                                     7%|▋         | 70/1071 [16:38<3:58:08, 14.27s/it]  7%|▋         | 71/1071 [16:53<3:57:55, 14.28s/it]  7%|▋         | 72/1071 [17:07<3:57:40, 14.27s/it]  7%|▋         | 73/1071 [17:21<3:56:50, 14.24s/it]  7%|▋         | 74/1071 [17:35<3:56:48, 14.25s/it]  7%|▋         | 75/1071 [17:49<3:56:43, 14.26s/it]  7%|▋         | 76/1071 [18:04<3:56:32, 14.26s/it]  7%|▋         | 77/1071 [18:18<3:56:21, 14.27s/it]  7%|▋         | 78/1071 [18:32<3:56:11, 14.27s/it]  7%|▋         | 79/1071 [18:47<3:55:59, 14.27s/it]  7%|▋         | 80/1071 [19:01<3:55:44, 14.27s/it]                                                     7%|▋         | 80/1071 [19:01<3:55:44, 14.27s/it]  8%|▊         | 81/1071 [19:15<3:55:31, 14.27s/it]  8%|▊         | 82/1071 [19:29<3:55:17, 14.27s/it]  8%|▊         | 83/1071 [19:44<3:55:03, 14.27s/it]  8%|▊         | 84/1071 [19:58<3:54:47, 14.27s/it]  8%|▊         | 85/1071 [20:12<3:54:32, 14.27s/it]  8%|▊         | 86/1071 [20:27<3:54:19, 14.27s/it]  8%|▊         | 87/1071 [20:41<3:54:06, 14.28s/it]  8%|▊         | 88/1071 [20:55<3:53:50, 14.27s/it]  8%|▊         | 89/1071 [21:09<3:53:37, 14.27s/it]  8%|▊         | 90/1071 [21:24<3:53:25, 14.28s/it]                                                     8%|▊         | 90/1071 [21:24<3:53:25, 14.28s/it]  8%|▊         | 91/1071 [21:38<3:53:10, 14.28s/it]  9%|▊         | 92/1071 [21:52<3:52:54, 14.27s/it]  9%|▊         | 93/1071 [22:06<3:52:39, 14.27s/it]  9%|▉         | 94/1071 [22:21<3:52:24, 14.27s/it]  9%|▉         | 95/1071 [22:35<3:52:07, 14.27s/it]  9%|▉         | 96/1071 [22:49<3:51:50, 14.27s/it]  9%|▉         | 97/1071 [23:04<3:51:39, 14.27s/it]  9%|▉         | 98/1071 [23:18<3:51:24, 14.27s/it]  9%|▉         | 99/1071 [23:32<3:51:12, 14.27s/it]  9%|▉         | 100/1071 [23:46<3:51:00, 14.27s/it]                                                      9%|▉         | 100/1071 [23:46<3:51:00, 14.27s/it]  9%|▉         | 101/1071 [24:01<3:50:47, 14.28s/it] 10%|▉         | 102/1071 [24:15<3:50:33, 14.28s/it] 10%|▉         | 103/1071 [24:29<3:50:17, 14.27s/it] 10%|▉         | 104/1071 [24:43<3:50:02, 14.27s/it] 10%|▉         | 105/1071 [24:58<3:49:50, 14.28s/it] 10%|▉         | 106/1071 [25:12<3:49:38, 14.28s/it] 10%|▉         | 107/1071 [25:26<3:49:22, 14.28s/it] 10%|█         | 108/1071 [25:41<3:49:07, 14.28s/it] 10%|█         | 109/1071 [25:55<3:48:52, 14.27s/it] 10%|█         | 110/1071 [26:09<3:48:07, 14.24s/it]                                                     10%|█         | 110/1071 [26:09<3:48:07, 14.24s/it] 10%|█         | 111/1071 [26:23<3:48:03, 14.25s/it] 10%|█         | 112/1071 [26:38<3:47:53, 14.26s/it] 11%|█         | 113/1071 [26:52<3:48:01, 14.28s/it] 11%|█         | 114/1071 [27:06<3:47:45, 14.28s/it] 11%|█         | 115/1071 [27:20<3:47:28, 14.28s/it] 11%|█         | 116/1071 [27:35<3:47:11, 14.27s/it] 11%|█         | 117/1071 [27:49<3:46:56, 14.27s/it] 11%|█         | 118/1071 [28:03<3:46:44, 14.28s/it] 11%|█         | 119/1071 [28:18<3:46:31, 14.28s/it] 11%|█         | 120/1071 [28:32<3:46:20, 14.28s/it]                                                     11%|█         | 120/1071 [28:32<3:46:20, 14.28s/it] 11%|█▏        | 121/1071 [28:46<3:46:07, 14.28s/it] 11%|█▏        | 122/1071 [29:00<3:45:48, 14.28s/it] 11%|█▏        | 123/1071 [29:15<3:45:33, 14.28s/it] 12%|█▏        | 124/1071 [29:29<3:45:18, 14.28s/it] 12%|█▏        | 125/1071 [29:43<3:45:03, 14.27s/it] 12%|█▏        | 126/1071 [29:57<3:44:48, 14.27s/it] 12%|█▏        | 127/1071 [30:12<3:44:37, 14.28s/it] 12%|█▏        | 128/1071 [30:26<3:44:23, 14.28s/it] 12%|█▏        | 129/1071 [30:40<3:44:07, 14.28s/it] 12%|█▏        | 130/1071 [30:55<3:43:53, 14.28s/it]                                                     12%|█▏        | 130/1071 [30:55<3:43:53, 14.28s/it] 12%|█▏        | 131/1071 [31:09<3:43:40, 14.28s/it] 12%|█▏        | 132/1071 [31:23<3:43:27, 14.28s/it] 12%|█▏        | 133/1071 [31:37<3:43:12, 14.28s/it] 13%|█▎        | 134/1071 [31:52<3:43:14, 14.30s/it] 13%|█▎        | 135/1071 [32:07<3:48:43, 14.66s/it] 13%|█▎        | 136/1071 [32:25<4:04:02, 15.66s/it] 13%|█▎        | 137/1071 [32:40<3:59:50, 15.41s/it] 13%|█▎        | 138/1071 [32:54<3:54:21, 15.07s/it] 13%|█▎        | 139/1071 [33:09<3:50:27, 14.84s/it] 13%|█▎        | 140/1071 [33:25<3:59:31, 15.44s/it]                                                     13%|█▎        | 140/1071 [33:25<3:59:31, 15.44s/it] 13%|█▎        | 141/1071 [33:40<3:53:53, 15.09s/it] 13%|█▎        | 142/1071 [33:54<3:49:52, 14.85s/it] 13%|█▎        | 143/1071 [34:08<3:47:01, 14.68s/it] 13%|█▎        | 144/1071 [34:23<3:44:56, 14.56s/it] 14%|█▎        | 145/1071 [34:37<3:43:21, 14.47s/it] 14%|█▎        | 146/1071 [34:51<3:42:13, 14.41s/it] 14%|█▎        | 147/1071 [35:05<3:41:22, 14.37s/it] 14%|█▍        | 148/1071 [35:21<3:44:49, 14.61s/it] 14%|█▍        | 149/1071 [35:39<4:00:10, 15.63s/it] 14%|█▍        | 150/1071 [35:53<3:53:44, 15.23s/it]                                                     14%|█▍        | 150/1071 [35:53<3:53:44, 15.23s/it] 14%|█▍        | 151/1071 [36:07<3:49:07, 14.94s/it] 14%|█▍        | 152/1071 [36:21<3:45:48, 14.74s/it] 14%|█▍        | 153/1071 [36:36<3:43:25, 14.60s/it] 14%|█▍        | 154/1071 [36:50<3:41:42, 14.51s/it] 14%|█▍        | 155/1071 [37:04<3:40:19, 14.43s/it] 15%|█▍        | 156/1071 [37:19<3:39:24, 14.39s/it] 15%|█▍        | 157/1071 [37:33<3:38:40, 14.35s/it] 15%|█▍        | 158/1071 [37:47<3:38:05, 14.33s/it] 15%|█▍        | 159/1071 [38:01<3:37:33, 14.31s/it] 15%|█▍        | 160/1071 [38:16<3:37:10, 14.30s/it]                                                     15%|█▍        | 160/1071 [38:16<3:37:10, 14.30s/it] 15%|█▌        | 161/1071 [38:30<3:36:50, 14.30s/it] 15%|█▌        | 162/1071 [38:44<3:36:29, 14.29s/it] 15%|█▌        | 163/1071 [38:58<3:36:10, 14.28s/it] 15%|█▌        | 164/1071 [39:13<3:35:52, 14.28s/it] 15%|█▌        | 165/1071 [39:27<3:35:37, 14.28s/it]